/**
 * @name 			angular-checkgroup
 * @description		build your custom radio and checkbox
 * @version 		0.1.3
 * @author			Jennie Ji
 * https://github.com/JennieJi/angular-checkgroup
 */
"use strict";angular.module("checkgroup",[]).controller("checkgroupController",["$scope",function(a){var b=[],c=[],d=[],e=this,f=!1;this.checkedValue=[],this.multiple=!1,this.model=null,this.last=-1,this.index=-1,this.registerCheck=function(a){var f=b;if(e.multiple)switch(a.checkType){case"all":f=c;break;case"none":f=d}a.$on("$destroy",function(){var b=f?f.indexOf(a):-1;0>b||(f.splice(b,1),e.index--,e.last--)}),f.push(a),(++e.index===e.last||a.$last)&&e.updateValue()},this.uncheckOthers=function(a){angular.forEach(b,function(b){b.isChecked=angular.equals(b,a)})},this.groupCheck=function(a,b){e.multiple&&angular.forEach(a,function(a){a.isChecked=b})},this.checkAll=function(a){this.groupCheck(b,a)},this.checkedLengthUpdate=function(a){this.groupCheck(c,a===b.length),this.groupCheck(d,0===a)},this.updateValue=function(){e.checkedValue=[],angular.forEach(b,function(a){return a.isChecked?!e.multiple&&e.checkedValue.length>0?void(a.isChecked=!1):void e.checkedValue.push(a.value):void 0}),this.checkedLengthUpdate(e.checkedValue.length),f=!0,a.checkgroup=e.checkedValue},a.$watch("checkgroup",function(a){return f||!angular.isArray(a)?void(f=!1):(angular.forEach(b,function(b){b.isChecked=e.multiple?a.indexOf(b.value)>=0:a[0]===b.value}),void e.checkedLengthUpdate(e.multiple?a.length:a.length?1:0))})}]).directive("checkgroup",function(){return{restrict:"AE",scope:{checkgroup:"=checkgroup"},controller:"checkgroupController",compile:function(){return{pre:function(a,b,c,d){d.model=c.checkgroup,d.last=b.find("check").length+b.find("[check]").length-1,d.multiple=c.checkMultiple||!1}}}}}).directive("check",[function(){return{restrict:"EA",scope:{value:"@",isChecked:"@checked",isDisabled:"=?checkDisabled"},transclude:!0,require:"^checkgroup",template:'<div class="check" ng-class="{checked:isChecked}" ng-mouseup="toggleCheck();" ng-transclude></div>',link:function(a,b,c,d){a.checkType=c.checkType,a.toggleCheck=function(){a.isDisabled||(a.isChecked=d.multiple?!a.isChecked:!0)},a.$watch("isChecked",function(b){if(!a.isDisabled){if(b)if(d.multiple)switch(a.checkType){case"all":d.checkAll(!0);break;case"none":d.checkAll(!1)}else d.uncheckOthers(a);d.updateValue()}}),d.registerCheck(a)}}}]);